


<div id="d-kernel-density-estimation" class="section level1">
<h1>2D Kernel Density Estimation</h1>
<p>In two dimensional case we can visualize the effects of bandwidth matrix <span class="math inline">\(\textbf{H}\)</span> choice. To construct <span class="math inline">\(\textbf{H}\)</span> matrix we can use</p>
<p><span class="math display">\[ \textbf{H}^{-1} =  \textbf{R}^T   \textbf{M}^{-1} \textbf{R}  \]</span></p>
<ul>
<li><span class="math inline">\(\textbf{R}\)</span> - is rotation matrix by angle <span class="math inline">\(\theta\)</span></li>
</ul>
<div class="figure">
<img src="data:image/png;base64,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" />

</div>
<ul>
<li><span class="math inline">\(\textbf{M}\)</span> - some scaling diagonal matrix</li>
</ul>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF0AAABCCAYAAAA18dqNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAUhSURBVHhe7ZzPa+JaFMff/+QuIAizEARXZlUp1NWUByMIT2bhquWBOIsn3XQWTwYG36IyMNhFSaE4Kx+UFIQMFIQHFgoXCikUAoUIwnfOTW6ctP5otMar8+4HhHp7qcnH5JyT9Nz8BsXaUdIloKRLQEmXgJIugenSHwYwL83J13+OmKAIcJk11ZXFXDFjkunSe3UkEonJ15ElJigC7NPiVFfFU1vMmGSu9HpPvFdE566NopL+MvZlE5W9NNI7eeiZNArVNvrLRlIl/WUYhQctoaN+JSyPGNolDYlcHdajP7QQSvoLPHRQSVIMrnbxJO31G8jS/uuf+mJgAZT0+TgXFW8/s8/lOvRl0Hgi28DC2pX0+VhHsyoNC3UuPVGEcS+GohK3dLd3jHwmhVQyj8MLBvuqgWJOR55ehWoHbCQmEvZlA2VKVPkcJaxSA+YdQ6dagJ6j5JUronk9u66NBxtG6SXpWTQWPdRjlT40UUsW0WaUeN75G8+Tj0kXVq3fU/Rew/F3fypPVvkDw/8SRgM0d/35OtX9Nv/ieFwtGaRhndjj7Z4tfYmzPU7p7r81JN4bcCjqNbJ8Awto3dAvRBJKJA/R4QXBg4FysobuuBII5pdhPACDzzr9rKF4tl7lWynduaFL3VsKCayNfb6Bb9tg4neu48AZijcjF44TCh03LeT5/N0WBmJIDlHCy8+zNTLrSKQzK4AZ2Gf+ZXPU+XESJZG278RQVNYh3TqiCwk+90oMzMVFt+ofQU/+9mPozFgjwQGjfXx2T+ne8MRtaMkYxOeKH7+n4NLf0vmOHXRILE++fD7F+HH4ocS7R1XCtXi/Tni+4XK93BTi2s9L2b+XOBtjly4+YF58tj7yMyGF8hkD+xrckRPSRw7MI92rYtZdMAZs3W0Ar4KheXPjMzNQyaSh75DcUhP9uz6apTRSGarZqW4vf7bghOp5GXjXEPz6gd/womuM8pGxwTe87i20T7tgyxwRvyrxx3TFBEq6BJR0CSjpElDSJaCkS0BJl4CSLgElXQJKugSUdAko6RJQ0iWgpEtASZeAbOkr7YbdFmRKX/m/wbYFadLj6IbdFmRJj6UbdluQJT2WbthtQY70mLphX8ujheOdNFJvNOT/7IDdmWiUdL9LYa+GTtATyDqo7elIZ1JI8+6FcP557KP5xz5q32YLlSY9lsbMV+HC/KCh+JV5CZ5/fkIk+cGXfaTovdflNaQvJkfjPXe8ai7c2Do4yc/YrxBKumDYRU10Cfc/Zb3PL5zw9qigQ03D4TcHznkZ2geTviIHxns+Hj4jg/3K+93Js9jc8LJEN+xrcAYwe4xkUtn6ln/+PtpBOBmS7KCrOOipvG2hwLdzrzXuRB4XAUkqeec1R21yIl24G3YVRKye2JfCxPYH3WwTZfBzZEmPpRt2FdB+afzz/zLFwDSCMPL0wAjCUuXihUtqWdJj6YZdAdHEBWcjhRExQikULW/JTigszUKadGLzbgNETITjeX7i5Z3F/RO+LzQW5QyVKZ2z0m7Y1+JVMBHF3fMaPg3tje51Fhd2/DNEi/JACtnSN4qRDeu0jS5fJzWPIcPgJnxkhMrHKAsXlPQFGa8U+VnSut+P/ZUkUZdcvlZ6+Z9nD4/51R+yI6or/UAsPL41cJjjwlsYzMhDEw/ZOa97qweXlj7x+h88ZIdd1FDgq753dcpDZdTP+3NXiqzuITuKWFHSJaCkS0BJl4CSLgElXQJKugSUdAko6RJQ0tcO8APXI6IRTk/8YAAAAABJRU5ErkJggg==" />

</div>
<p>And finally we got: <span class="math display">\[ \textbf{H} = (\textbf{R}^T   \textbf{M}^{-1} \textbf{R})^{-1} \]</span></p>
<p>We can visualize bandwidth matrix as rotated ellipse with axis rx, ry and <span class="math inline">\(\theta\)</span>. In this shiny application you can choose number of parameters to see effects of bandwidth matrix.</p>
</div>

